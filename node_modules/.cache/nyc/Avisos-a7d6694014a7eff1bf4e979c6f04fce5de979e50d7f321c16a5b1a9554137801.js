function cov_1bxcbs12f2(){var path="C:\\Users\\Manu\\IdeaProjects\\TFG\\server\\routes\\Avisos.js";var hash="74cc182ec4d53be074539ed2ddca17bdae485f07";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Manu\\IdeaProjects\\TFG\\server\\routes\\Avisos.js",statementMap:{"0":{start:{line:1,column:16},end:{line:1,column:34}},"1":{start:{line:2,column:15},end:{line:2,column:31}},"2":{start:{line:3,column:38},end:{line:3,column:58}},"3":{start:{line:4,column:26},end:{line:4,column:66}},"4":{start:{line:8,column:0},end:{line:51,column:3}},"5":{start:{line:9,column:43},end:{line:9,column:51}},"6":{start:{line:12,column:4},end:{line:47,column:5}},"7":{start:{line:14,column:8},end:{line:17,column:11}},"8":{start:{line:20,column:31},end:{line:24,column:10}},"9":{start:{line:27,column:8},end:{line:40,column:9}},"10":{start:{line:29,column:12},end:{line:32,column:15}},"11":{start:{line:34,column:12},end:{line:39,column:14}},"12":{start:{line:44,column:8},end:{line:46,column:9}},"13":{start:{line:45,column:12},end:{line:45,column:30}},"14":{start:{line:49,column:4},end:{line:49,column:31}},"15":{start:{line:55,column:0},end:{line:70,column:3}},"16":{start:{line:57,column:33},end:{line:57,column:46}},"17":{start:{line:59,column:27},end:{line:64,column:6}},"18":{start:{line:66,column:30},end:{line:66,column:47}},"19":{start:{line:68,column:4},end:{line:68,column:32}},"20":{start:{line:74,column:0},end:{line:107,column:3}},"21":{start:{line:76,column:33},end:{line:76,column:46}},"22":{start:{line:77,column:16},end:{line:77,column:28}},"23":{start:{line:79,column:19},end:{line:84,column:6}},"24":{start:{line:86,column:4},end:{line:100,column:5}},"25":{start:{line:88,column:8},end:{line:94,column:9}},"26":{start:{line:89,column:12},end:{line:93,column:14}},"27":{start:{line:97,column:8},end:{line:99,column:9}},"28":{start:{line:98,column:12},end:{line:98,column:30}},"29":{start:{line:105,column:4},end:{line:105,column:21}},"30":{start:{line:109,column:0},end:{line:135,column:3}},"31":{start:{line:110,column:20},end:{line:110,column:38}},"32":{start:{line:112,column:4},end:{line:132,column:5}},"33":{start:{line:114,column:22},end:{line:114,column:52}},"34":{start:{line:116,column:8},end:{line:126,column:9}},"35":{start:{line:117,column:12},end:{line:121,column:15}},"36":{start:{line:123,column:12},end:{line:123,column:45}},"37":{start:{line:125,column:12},end:{line:125,column:70}},"38":{start:{line:129,column:8},end:{line:131,column:9}},"39":{start:{line:130,column:12},end:{line:130,column:30}},"40":{start:{line:138,column:0},end:{line:138,column:24}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:8,column:43},end:{line:8,column:44}},loc:{start:{line:8,column:63},end:{line:51,column:1}},line:8},"1":{name:"(anonymous_1)",decl:{start:{line:55,column:47},end:{line:55,column:48}},loc:{start:{line:55,column:67},end:{line:70,column:1}},line:55},"2":{name:"(anonymous_2)",decl:{start:{line:74,column:45},end:{line:74,column:46}},loc:{start:{line:74,column:65},end:{line:107,column:1}},line:74},"3":{name:"(anonymous_3)",decl:{start:{line:109,column:54},end:{line:109,column:55}},loc:{start:{line:109,column:74},end:{line:135,column:1}},line:109}},branchMap:{"0":{loc:{start:{line:27,column:8},end:{line:40,column:9}},type:"if",locations:[{start:{line:27,column:8},end:{line:40,column:9}},{start:{line:27,column:8},end:{line:40,column:9}}],line:27},"1":{loc:{start:{line:44,column:8},end:{line:46,column:9}},type:"if",locations:[{start:{line:44,column:8},end:{line:46,column:9}},{start:{line:44,column:8},end:{line:46,column:9}}],line:44},"2":{loc:{start:{line:88,column:8},end:{line:94,column:9}},type:"if",locations:[{start:{line:88,column:8},end:{line:94,column:9}},{start:{line:88,column:8},end:{line:94,column:9}}],line:88},"3":{loc:{start:{line:97,column:8},end:{line:99,column:9}},type:"if",locations:[{start:{line:97,column:8},end:{line:99,column:9}},{start:{line:97,column:8},end:{line:99,column:9}}],line:97},"4":{loc:{start:{line:116,column:8},end:{line:126,column:9}},type:"if",locations:[{start:{line:116,column:8},end:{line:126,column:9}},{start:{line:116,column:8},end:{line:126,column:9}}],line:116},"5":{loc:{start:{line:129,column:8},end:{line:131,column:9}},type:"if",locations:[{start:{line:129,column:8},end:{line:131,column:9}},{start:{line:129,column:8},end:{line:131,column:9}}],line:129}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"74cc182ec4d53be074539ed2ddca17bdae485f07"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1bxcbs12f2=function(){return actualCoverage;};}return actualCoverage;}cov_1bxcbs12f2();const express=(cov_1bxcbs12f2().s[0]++,require("express"));const router=(cov_1bxcbs12f2().s[1]++,express.Router());const{Avisos,NotificacionAviso}=(cov_1bxcbs12f2().s[2]++,require("../models"));const{validateToken}=(cov_1bxcbs12f2().s[3]++,require("../middlewares/AuthMiddleware"));//crear un aviso
cov_1bxcbs12f2().s[4]++;router.post("/createAviso",validateToken,async(req,res)=>{cov_1bxcbs12f2().f[0]++;const{aviso,PersonasDependienteId}=(cov_1bxcbs12f2().s[5]++,req.body);cov_1bxcbs12f2().s[6]++;try{cov_1bxcbs12f2().s[7]++;await Avisos.create({aviso:aviso,PersonasDependienteId:PersonasDependienteId});// Busca si esta creada la notificacion de aviso para esa persona
const notificaciones=(cov_1bxcbs12f2().s[8]++,await NotificacionAviso.findAll({where:{PersonasDependienteId:PersonasDependienteId}}));cov_1bxcbs12f2().s[9]++;if(notificaciones.length===0){cov_1bxcbs12f2().b[0][0]++;cov_1bxcbs12f2().s[10]++;await NotificacionAviso.create({nueva:true,PersonasDependienteId:PersonasDependienteId});}else{cov_1bxcbs12f2().b[0][1]++;cov_1bxcbs12f2().s[11]++;await NotificacionAviso.update({nueva:true},{where:{PersonasDependienteId:PersonasDependienteId}});}}catch(e){cov_1bxcbs12f2().s[12]++;if(e){cov_1bxcbs12f2().b[1][0]++;cov_1bxcbs12f2().s[13]++;return res.json(e);}else{cov_1bxcbs12f2().b[1][1]++;}}cov_1bxcbs12f2().s[14]++;return res.json("SUCCESS");});//VER SI HAY NOTIFICACION AVISO
cov_1bxcbs12f2().s[15]++;router.get('/notificacion/:id',validateToken,async(req,res)=>{cov_1bxcbs12f2().f[1]++;const personaDependienteId=(cov_1bxcbs12f2().s[16]++,req.params.id);const notificaciones=(cov_1bxcbs12f2().s[17]++,await NotificacionAviso.findAll({where:{PersonasDependienteId:personaDependienteId}}));const notificacionAviso=(cov_1bxcbs12f2().s[18]++,notificaciones[0]);cov_1bxcbs12f2().s[19]++;res.json(notificacionAviso);});//VER LOS AVISOS DE UNA PERSONA
cov_1bxcbs12f2().s[20]++;router.get('/showAvisos/:id',validateToken,async(req,res)=>{cov_1bxcbs12f2().f[2]++;const personaDependienteId=(cov_1bxcbs12f2().s[21]++,req.params.id);const rol=(cov_1bxcbs12f2().s[22]++,req.user.rol);const avisos=(cov_1bxcbs12f2().s[23]++,await Avisos.findAll({where:{PersonasDependienteId:personaDependienteId}}));cov_1bxcbs12f2().s[24]++;try{cov_1bxcbs12f2().s[25]++;if(rol==="AUXILIAR"){cov_1bxcbs12f2().b[2][0]++;cov_1bxcbs12f2().s[26]++;await NotificacionAviso.update({nueva:false},{where:{PersonasDependienteId:personaDependienteId}});}else{cov_1bxcbs12f2().b[2][1]++;}}catch(e){cov_1bxcbs12f2().s[27]++;if(e){cov_1bxcbs12f2().b[3][0]++;cov_1bxcbs12f2().s[28]++;return res.json(e);}else{cov_1bxcbs12f2().b[3][1]++;}}cov_1bxcbs12f2().s[29]++;res.json(avisos);});//Borrar un aviso
cov_1bxcbs12f2().s[30]++;router.delete("/deleteAviso/:avisoId",validateToken,async(req,res)=>{cov_1bxcbs12f2().f[3]++;const avisoId=(cov_1bxcbs12f2().s[31]++,req.params.avisoId);cov_1bxcbs12f2().s[32]++;try{const aviso=(cov_1bxcbs12f2().s[33]++,await Avisos.findByPk(avisoId));cov_1bxcbs12f2().s[34]++;if(aviso){cov_1bxcbs12f2().b[4][0]++;cov_1bxcbs12f2().s[35]++;await Avisos.destroy({where:{id:avisoId}});cov_1bxcbs12f2().s[36]++;res.json("DELETED SUCCESSFULLY");}else{cov_1bxcbs12f2().b[4][1]++;cov_1bxcbs12f2().s[37]++;return res.json({error:"There is no aviso with this id"});}}catch(e){cov_1bxcbs12f2().s[38]++;if(e){cov_1bxcbs12f2().b[5][0]++;cov_1bxcbs12f2().s[39]++;return res.json(e);}else{cov_1bxcbs12f2().b[5][1]++;}}});cov_1bxcbs12f2().s[40]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkF2aXNvcy5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIkF2aXNvcyIsIk5vdGlmaWNhY2lvbkF2aXNvIiwidmFsaWRhdGVUb2tlbiIsInBvc3QiLCJyZXEiLCJyZXMiLCJhdmlzbyIsIlBlcnNvbmFzRGVwZW5kaWVudGVJZCIsImJvZHkiLCJjcmVhdGUiLCJub3RpZmljYWNpb25lcyIsImZpbmRBbGwiLCJ3aGVyZSIsImxlbmd0aCIsIm51ZXZhIiwidXBkYXRlIiwiZSIsImpzb24iLCJnZXQiLCJwZXJzb25hRGVwZW5kaWVudGVJZCIsInBhcmFtcyIsImlkIiwibm90aWZpY2FjaW9uQXZpc28iLCJyb2wiLCJ1c2VyIiwiYXZpc29zIiwiZGVsZXRlIiwiYXZpc29JZCIsImZpbmRCeVBrIiwiZGVzdHJveSIsImVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ims2SkFlWTsyRkFmWixLQUFNQSxDQUFBQSxPQUFPLDBCQUFHQyxPQUFPLENBQUMsU0FBRCxDQUFWLENBQWIsQ0FDQSxLQUFNQyxDQUFBQSxNQUFNLDBCQUFHRixPQUFPLENBQUNHLE1BQVIsRUFBSCxDQUFaLENBQ0EsS0FBTSxDQUFFQyxNQUFGLENBQVVDLGlCQUFWLDJCQUFnQ0osT0FBTyxDQUFDLFdBQUQsQ0FBdkMsQ0FBTixDQUNBLEtBQU0sQ0FBRUssYUFBRiwyQkFBb0JMLE9BQU8sQ0FBQywrQkFBRCxDQUEzQixDQUFOLENBR0E7d0JBQ0FDLE1BQU0sQ0FBQ0ssSUFBUCxDQUFZLGNBQVosQ0FBNEJELGFBQTVCLENBQTJDLE1BQU9FLEdBQVAsQ0FBWUMsR0FBWixHQUFvQix5QkFDM0QsS0FBTSxDQUFDQyxLQUFELENBQVFDLHFCQUFSLDJCQUFpQ0gsR0FBRyxDQUFDSSxJQUFyQyxDQUFOLENBRDJELHdCQUkzRCxHQUFJLHlCQUVBLEtBQU1SLENBQUFBLE1BQU0sQ0FBQ1MsTUFBUCxDQUFjLENBQ2hCSCxLQUFLLENBQUVBLEtB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NEIsTUFBUCxDQUFjLHVCQUFkLENBQXVDeEIsYUFBdkMsQ0FBc0QsTUFBT0UsR0FBUCxDQUFZQyxHQUFaLEdBQW9CLHlCQUN0RSxLQUFNc0IsQ0FBQUEsT0FBTywyQkFBR3ZCLEdBQUcsQ0FBQ2dCLE1BQUosQ0FBV08sT0FBZCxDQUFiLENBRHNFLHlCQUd0RSxHQUFJLENBRUEsS0FBTXJCLENBQUFBLEtBQUssMkJBQUcsS0FBTU4sQ0FBQUEsTUFBTSxDQUFDNEIsUUFBUCxDQUFnQkQsT0FBaEIsQ0FBVCxDQUFYLENBRkEseUJBSUEsR0FBR3JCLEtBQUgsQ0FBUyxxREFDTCxLQUFNTixDQUFBQSxNQUFNLENBQUM2QixPQUFQLENBQWUsQ0FDakJqQixLQUFLLENBQUUsQ0FDSFMsRUFBRSxDQUFFTSxPQURELENBRFUsQ0FBZixDQUFOLENBREsseUJBT0x0QixHQUFHLENBQUNZLElBQUosQ0FBUyxzQkFBVCxFQUNILENBUkQsSUFRTyxxREFDSCxNQUFPWixDQUFBQSxHQUFHLENBQUNZLElBQUosQ0FBUyxDQUFDYSxLQUFLLENBQUUsZ0NBQVIsQ0FBVCxDQUFQLENBQ0gsQ0FFSixDQUFDLE1BQU9kLENBQVAsQ0FBVSwwQkFDUixHQUFHQSxDQUFILENBQU0scURBQ0YsTUFBT1gsQ0FBQUEsR0FBRyxDQUFDWSxJQUFKLENBQVNELENBQVQsQ0FBUCxDQUNILENBRkQsaUNBR0gsQ0FHSixDQTFCRCxFLHlCQTZCQWUsTUFBTSxDQUFDQyxPQUFQLENBQWlCbEMsTUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZShcImV4cHJlc3NcIik7XHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbmNvbnN0IHsgQXZpc29zLCBOb3RpZmljYWNpb25BdmlzbyB9ID0gcmVxdWlyZShcIi4uL21vZGVsc1wiKTtcclxuY29uc3QgeyB2YWxpZGF0ZVRva2VuIH0gPSByZXF1aXJlKFwiLi4vbWlkZGxld2FyZXMvQXV0aE1pZGRsZXdhcmVcIik7XHJcblxyXG5cclxuLy9jcmVhciB1biBhdmlzb1xyXG5yb3V0ZXIucG9zdChcIi9jcmVhdGVBdmlzb1wiLCB2YWxpZGF0ZVRva2VuLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgIGNvbnN0IHthdmlzbywgUGVyc29uYXNEZXBlbmRpZW50ZUlkfSA9IHJlcS5ib2R5O1xyXG5cclxuXHJcbiAgICB0cnkge1xyXG5cclxuICAgICAgICBhd2FpdCBBdmlzb3MuY3JlYXRlKHtcclxuICAgICAgICAgICAgYXZpc286IGF2aXNvLFxyXG4gICAgICAgICAgICBQZXJzb25hc0RlcGVuZGllbnRlSWQ6IFBlcnNvbmFzRGVwZW5kaWVudGVJZCxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQnVzY2Egc2kgZXN0YSBjcmVhZGEgbGEgbm90aWZpY2FjaW9uIGRlIGF2aXNvIHBhcmEgZXNhIHBlcnNvbmFcclxuICAgICAgICBjb25zdCBub3RpZmljYWNpb25lcyA9IGF3YWl0IE5vdGlmaWNhY2lvbkF2aXNvLmZpbmRBbGwoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgUGVyc29uYXNEZXBlbmRpZW50ZUlkOiBQZXJzb25hc0RlcGVuZGllbnRlSWQsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG5cclxuXHJcbiAgICAgICAgaWYobm90aWZpY2FjaW9uZXMubGVuZ3RoID09PSAwKSB7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBOb3RpZmljYWNpb25Bdmlzby5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgbnVldmE6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBQZXJzb25hc0RlcGVuZGllbnRlSWQ6IFBlcnNvbmFzRGVwZW5kaWVudGVJZCxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYXdhaXQgTm90aWZpY2FjaW9uQXZpc28udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBudWV2YTogdHJ1ZSxcclxuXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge3doZXJlOiB7UGVyc29uYXNEZXBlbmRpZW50ZUlkOiBQZXJzb25hc0RlcGVuZGllbnRlSWR9fVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGlmKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKGUpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXMuanNvbihcIlNVQ0NFU1NcIik7XHJcblxyXG59KTtcclxuXHJcblxyXG4vL1ZFUiBTSSBIQVkgTk9USUZJQ0FDSU9OIEFWSVNPXHJcbnJvdXRlci5nZXQoJy9ub3RpZmljYWNpb24vOmlkJywgdmFsaWRhdGVUb2tlbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcblxyXG4gICAgY29uc3QgcGVyc29uYURlcGVuZGllbnRlSWQgPSByZXEucGFyYW1zLmlkO1xyXG5cclxuICAgIGNvbnN0IG5vdGlmaWNhY2lvbmVzID0gYXdhaXQgTm90aWZpY2FjaW9uQXZpc28uZmluZEFsbCh7XHJcbiAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgUGVyc29uYXNEZXBlbmRpZW50ZUlkOiBwZXJzb25hRGVwZW5kaWVudGVJZCxcclxuICAgICAgICB9XHJcblxyXG4gICAgfSlcclxuXHJcbiAgICBjb25zdCBub3RpZmljYWNpb25BdmlzbyA9IG5vdGlmaWNhY2lvbmVzWzBdXHJcblxyXG4gICAgcmVzLmpzb24obm90aWZpY2FjaW9uQXZpc28pO1xyXG5cclxufSk7XHJcblxyXG5cclxuLy9WRVIgTE9TIEFWSVNPUyBERSBVTkEgUEVSU09OQVxyXG5yb3V0ZXIuZ2V0KCcvc2hvd0F2aXNvcy86aWQnLCB2YWxpZGF0ZVRva2VuLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuXHJcbiAgICBjb25zdCBwZXJzb25hRGVwZW5kaWVudGVJZCA9IHJlcS5wYXJhbXMuaWQ7XHJcbiAgICBjb25zdCByb2wgPSByZXEudXNlci5yb2w7XHJcblxyXG4gICAgY29uc3QgYXZpc29zID0gYXdhaXQgQXZpc29zLmZpbmRBbGwoe1xyXG4gICAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgICAgIFBlcnNvbmFzRGVwZW5kaWVudGVJZDogcGVyc29uYURlcGVuZGllbnRlSWQsXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pXHJcblxyXG4gICAgdHJ5IHtcclxuXHJcbiAgICAgICAgaWYocm9sID09PSBcIkFVWElMSUFSXCIpe1xyXG4gICAgICAgICAgICBhd2FpdCBOb3RpZmljYWNpb25Bdmlzby51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIG51ZXZhOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7d2hlcmU6IHtQZXJzb25hc0RlcGVuZGllbnRlSWQ6IHBlcnNvbmFEZXBlbmRpZW50ZUlkfX1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGlmKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKGUpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcblxyXG5cclxuICAgIHJlcy5qc29uKGF2aXNvcyk7XHJcblxyXG59KTtcclxuLy9Cb3JyYXIgdW4gYXZpc29cclxucm91dGVyLmRlbGV0ZShcIi9kZWxldGVBdmlzby86YXZpc29JZFwiLCB2YWxpZGF0ZVRva2VuLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgIGNvbnN0IGF2aXNvSWQgPSByZXEucGFyYW1zLmF2aXNvSWQ7XHJcblxyXG4gICAgdHJ5IHtcclxuXHJcbiAgICAgICAgY29uc3QgYXZpc28gPSBhd2FpdCBBdmlzb3MuZmluZEJ5UGsoYXZpc29JZClcclxuXHJcbiAgICAgICAgaWYoYXZpc28pe1xyXG4gICAgICAgICAgICBhd2FpdCBBdmlzb3MuZGVzdHJveSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBhdmlzb0lkLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXMuanNvbihcIkRFTEVURUQgU1VDQ0VTU0ZVTExZXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbih7ZXJyb3I6IFwiVGhlcmUgaXMgbm8gYXZpc28gd2l0aCB0aGlzIGlkXCJ9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgaWYoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oZSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxufSk7XHJcblxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7Il19