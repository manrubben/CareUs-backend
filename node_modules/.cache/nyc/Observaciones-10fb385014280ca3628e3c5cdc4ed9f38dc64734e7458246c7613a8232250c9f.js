function cov_2javn51mqc(){var path="C:\\Users\\Manu\\IdeaProjects\\TFG\\server\\routes\\Observaciones.js";var hash="8bef838c7d1a17dbbf2c4e97c7f2fb23d5b9a4d9";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Manu\\IdeaProjects\\TFG\\server\\routes\\Observaciones.js",statementMap:{"0":{start:{line:1,column:16},end:{line:1,column:34}},"1":{start:{line:2,column:15},end:{line:2,column:31}},"2":{start:{line:3,column:51},end:{line:3,column:71}},"3":{start:{line:4,column:26},end:{line:4,column:66}},"4":{start:{line:8,column:0},end:{line:58,column:3}},"5":{start:{line:9,column:75},end:{line:9,column:83}},"6":{start:{line:14,column:4},end:{line:54,column:5}},"7":{start:{line:17,column:31},end:{line:21,column:10}},"8":{start:{line:23,column:8},end:{line:31,column:11}},"9":{start:{line:33,column:8},end:{line:47,column:9}},"10":{start:{line:35,column:12},end:{line:35,column:69}},"11":{start:{line:36,column:12},end:{line:39,column:15}},"12":{start:{line:41,column:12},end:{line:46,column:14}},"13":{start:{line:51,column:8},end:{line:53,column:9}},"14":{start:{line:52,column:12},end:{line:52,column:30}},"15":{start:{line:56,column:4},end:{line:56,column:31}},"16":{start:{line:62,column:0},end:{line:77,column:3}},"17":{start:{line:64,column:33},end:{line:64,column:46}},"18":{start:{line:66,column:27},end:{line:71,column:6}},"19":{start:{line:73,column:25},end:{line:73,column:42}},"20":{start:{line:75,column:4},end:{line:75,column:27}},"21":{start:{line:81,column:0},end:{line:114,column:3}},"22":{start:{line:83,column:33},end:{line:83,column:46}},"23":{start:{line:84,column:16},end:{line:84,column:28}},"24":{start:{line:86,column:26},end:{line:91,column:6}},"25":{start:{line:93,column:4},end:{line:107,column:5}},"26":{start:{line:95,column:8},end:{line:101,column:9}},"27":{start:{line:96,column:12},end:{line:100,column:14}},"28":{start:{line:104,column:8},end:{line:106,column:9}},"29":{start:{line:105,column:12},end:{line:105,column:30}},"30":{start:{line:112,column:4},end:{line:112,column:28}},"31":{start:{line:116,column:0},end:{line:134,column:3}},"32":{start:{line:117,column:26},end:{line:117,column:50}},"33":{start:{line:119,column:24},end:{line:119,column:67}},"34":{start:{line:121,column:4},end:{line:131,column:5}},"35":{start:{line:122,column:8},end:{line:126,column:11}},"36":{start:{line:128,column:8},end:{line:128,column:41}},"37":{start:{line:130,column:8},end:{line:130,column:72}},"38":{start:{line:137,column:0},end:{line:137,column:24}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:8,column:49},end:{line:8,column:50}},loc:{start:{line:8,column:69},end:{line:58,column:1}},line:8},"1":{name:"(anonymous_1)",decl:{start:{line:62,column:47},end:{line:62,column:48}},loc:{start:{line:62,column:67},end:{line:77,column:1}},line:62},"2":{name:"(anonymous_2)",decl:{start:{line:81,column:52},end:{line:81,column:53}},loc:{start:{line:81,column:72},end:{line:114,column:1}},line:81},"3":{name:"(anonymous_3)",decl:{start:{line:116,column:66},end:{line:116,column:67}},loc:{start:{line:116,column:86},end:{line:134,column:1}},line:116}},branchMap:{"0":{loc:{start:{line:33,column:8},end:{line:47,column:9}},type:"if",locations:[{start:{line:33,column:8},end:{line:47,column:9}},{start:{line:33,column:8},end:{line:47,column:9}}],line:33},"1":{loc:{start:{line:51,column:8},end:{line:53,column:9}},type:"if",locations:[{start:{line:51,column:8},end:{line:53,column:9}},{start:{line:51,column:8},end:{line:53,column:9}}],line:51},"2":{loc:{start:{line:95,column:8},end:{line:101,column:9}},type:"if",locations:[{start:{line:95,column:8},end:{line:101,column:9}},{start:{line:95,column:8},end:{line:101,column:9}}],line:95},"3":{loc:{start:{line:104,column:8},end:{line:106,column:9}},type:"if",locations:[{start:{line:104,column:8},end:{line:106,column:9}},{start:{line:104,column:8},end:{line:106,column:9}}],line:104},"4":{loc:{start:{line:121,column:4},end:{line:131,column:5}},type:"if",locations:[{start:{line:121,column:4},end:{line:131,column:5}},{start:{line:121,column:4},end:{line:131,column:5}}],line:121}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"8bef838c7d1a17dbbf2c4e97c7f2fb23d5b9a4d9"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2javn51mqc=function(){return actualCoverage;};}return actualCoverage;}cov_2javn51mqc();const express=(cov_2javn51mqc().s[0]++,require("express"));const router=(cov_2javn51mqc().s[1]++,express.Router());const{Observaciones,NotificacionObservacion}=(cov_2javn51mqc().s[2]++,require("../models"));const{validateToken}=(cov_2javn51mqc().s[3]++,require("../middlewares/AuthMiddleware"));//crear una observacion
cov_2javn51mqc().s[4]++;router.post("/createObservacion",validateToken,async(req,res)=>{cov_2javn51mqc().f[0]++;const{titulo,descripcion,username,UserId,PersonasDependienteId}=(cov_2javn51mqc().s[5]++,req.body);//const username = req.user.username;
//const userId = req.user.id;
cov_2javn51mqc().s[6]++;try{// Busca si esta creada la notificacion para esa persona
const notificaciones=(cov_2javn51mqc().s[7]++,await NotificacionObservacion.findAll({where:{PersonasDependienteId:PersonasDependienteId}}));cov_2javn51mqc().s[8]++;await Observaciones.create({titulo:titulo,descripcion:descripcion,username:username,PersonasDependienteId:PersonasDependienteId,UserId:UserId});cov_2javn51mqc().s[9]++;if(notificaciones.length===0){cov_2javn51mqc().b[0][0]++;cov_2javn51mqc().s[10]++;console.log("================="+PersonasDependienteId);cov_2javn51mqc().s[11]++;await NotificacionObservacion.create({nueva:true,PersonasDependienteId:PersonasDependienteId});}else{cov_2javn51mqc().b[0][1]++;cov_2javn51mqc().s[12]++;await NotificacionObservacion.update({nueva:true},{where:{PersonasDependienteId:PersonasDependienteId}});}}catch(e){cov_2javn51mqc().s[13]++;if(e){cov_2javn51mqc().b[1][0]++;cov_2javn51mqc().s[14]++;return res.json(e);}else{cov_2javn51mqc().b[1][1]++;}}cov_2javn51mqc().s[15]++;return res.json("SUCCESS");});//VER SI HAY NOTIFICACION
cov_2javn51mqc().s[16]++;router.get('/notificacion/:id',validateToken,async(req,res)=>{cov_2javn51mqc().f[1]++;const personaDependienteId=(cov_2javn51mqc().s[17]++,req.params.id);const notificaciones=(cov_2javn51mqc().s[18]++,await NotificacionObservacion.findAll({where:{PersonasDependienteId:personaDependienteId}}));const notificacion=(cov_2javn51mqc().s[19]++,notificaciones[0]);cov_2javn51mqc().s[20]++;res.json(notificacion);});//VER REGISTRO DE UN DIA
cov_2javn51mqc().s[21]++;router.get('/showObservaciones/:id',validateToken,async(req,res)=>{cov_2javn51mqc().f[2]++;const personaDependienteId=(cov_2javn51mqc().s[22]++,req.params.id);const rol=(cov_2javn51mqc().s[23]++,req.user.rol);const observaciones=(cov_2javn51mqc().s[24]++,await Observaciones.findAll({where:{PersonasDependienteId:personaDependienteId}}));cov_2javn51mqc().s[25]++;try{cov_2javn51mqc().s[26]++;if(rol==="FAMILIAR"){cov_2javn51mqc().b[2][0]++;cov_2javn51mqc().s[27]++;await NotificacionObservacion.update({nueva:false},{where:{PersonasDependienteId:personaDependienteId}});}else{cov_2javn51mqc().b[2][1]++;}}catch(e){cov_2javn51mqc().s[28]++;if(e){cov_2javn51mqc().b[3][0]++;cov_2javn51mqc().s[29]++;return res.json(e);}else{cov_2javn51mqc().b[3][1]++;}}cov_2javn51mqc().s[30]++;res.json(observaciones);});//Borrar una observacion
cov_2javn51mqc().s[31]++;router.delete("/deleteObservacion/:observacionId",validateToken,async(req,res)=>{cov_2javn51mqc().f[3]++;const observacionId=(cov_2javn51mqc().s[32]++,req.params.observacionId);const observacion=(cov_2javn51mqc().s[33]++,await Observaciones.findByPk(observacionId));cov_2javn51mqc().s[34]++;if(observacion){cov_2javn51mqc().b[4][0]++;cov_2javn51mqc().s[35]++;await Observaciones.destroy({where:{id:observacionId}});cov_2javn51mqc().s[36]++;res.json("DELETED SUCCESSFULLY");}else{cov_2javn51mqc().b[4][1]++;cov_2javn51mqc().s[37]++;return res.json({error:"There is no observacion with this id"});}});cov_2javn51mqc().s[38]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk9ic2VydmFjaW9uZXMuanMiXSwibmFtZXMiOlsiZXhwcmVzcyIsInJlcXVpcmUiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJPYnNlcnZhY2lvbmVzIiwiTm90aWZpY2FjaW9uT2JzZXJ2YWNpb24iLCJ2YWxpZGF0ZVRva2VuIiwicG9zdCIsInJlcSIsInJlcyIsInRpdHVsbyIsImRlc2NyaXBjaW9uIiwidXNlcm5hbWUiLCJVc2VySWQiLCJQZXJzb25hc0RlcGVuZGllbnRlSWQiLCJib2R5Iiwibm90aWZpY2FjaW9uZXMiLCJmaW5kQWxsIiwid2hlcmUiLCJjcmVhdGUiLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwibnVldmEiLCJ1cGRhdGUiLCJlIiwianNvbiIsImdldCIsInBlcnNvbmFEZXBlbmRpZW50ZUlkIiwicGFyYW1zIiwiaWQiLCJub3RpZmljYWNpb24iLCJyb2wiLCJ1c2VyIiwib2JzZXJ2YWNpb25lcyIsImRlbGV0ZSIsIm9ic2VydmFjaW9uSWQiLCJvYnNlcnZhY2lvbiIsImZpbmRCeVBrIiwiZGVzdHJveSIsImVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IjRtSkFlWTsyRkFmWixLQUFNQSxDQUFBQSxPQUFPLDBCQUFHQyxPQUFPLENBQUMsU0FBRCxDQUFWLENBQWIsQ0FDQSxLQUFNQyxDQUFBQSxNQUFNLDBCQUFHRixPQUFPLENBQUNHLE1BQVIsRUFBSCxDQUFaLENBQ0EsS0FBTSxDQUFFQyxhQUFGLENBQWlCQyx1QkFBakIsMkJBQTZDSixPQUFPLENBQUMsV0FBRCxDQUFwRCxDQUFOLENBQ0EsS0FBTSxDQUFFSyxhQUFGLDJCQUFvQkwsT0FBTyxDQUFDLCtCQUFELENBQTNCLENBQU4sQ0FHQTt3QkFDQUMsTUFBTSxDQUFDSyxJQUFQLENBQVksb0JBQVosQ0FBa0NELGFBQWxDLENBQWlELE1BQU9FLEdBQVAsQ0FBWUMsR0FBWixHQUFvQix5QkFDakUsS0FBTSxDQUFDQyxNQUFELENBQVNDLFdBQVQsQ0FBc0JDLFFBQXRCLENBQWdDQyxNQUFoQyxDQUF3Q0MscUJBQXhDLDJCQUFpRU4sR0FBRyxDQUFDTyxJQUFyRSxDQUFOLENBQ0E7QUFDQTtBQUhpRSx3QkFNakUsR0FBSSxDQUVBO0FBQ0EsS0FBTUMsQ0FBQUEsY0FBYywwQkFBRyxLQUFNWCxDQUFBQSx1QkFBdUIsQ0FBQ1ksT0FBeEIsQ0FBZ0MsQ0FDekRDLEtBQUssQ0FBRSxDQUNISixxQkFBcUIsQ0FBRUEscUJBRHBCLENBRGtELENBQWhDLENBQVQsQ0FBcEIsQ0FIQSx3QkFTQSxLQUFNVixDQUFBQSxhQUFhLENBQUNlLE1BQWQsQ0FBcUIsQ0FDdkJULE1BQU0sQ0FBRUEsTUFEZSxDQUV2QkMsV0FBVyxDQUFFQSxXQUZVLENBR3ZCQyxRQUFRLENBQUVBLFFBSGEsQ0FJdkJFLHFCQUFxQixDQUFFQSxxQkFKQSxDQUt2QkQsTUFBTSxDQUFFQSxNQUxlLENBQXJCLENBQU4sQ0FUQSx3QkFtQkEsR0FBR0csY0FBYyxDQUFDSSxNQUFmLEdBQTBCLENBQTdCLENBQWdDLHFEQUU1QkMsT0FBTyxDQUFDQyxHQUFSLENBQVksb0JBQXNCUixxQkFBbEMsRUFGNEIseUJBRzVCLEtBQU1ULENBQUFBLHVCQUF1QixDQUFDYyxNQUF4QixDQUErQixDQUNqQ0ksS0FBSyxDQUFFLElBRDBCLENBRWpDVCxxQkFBcUIsQ0FBRUEscUJBRlUsQ0FBL0IsQ0FBTixDQUlILENBUEQsSUFPTyxxREFDSCxLQUFNVCxDQUFBQSx1QkFBdUIsQ0FBQ21CLE1BQXhCLENBQStCLENBQzdCRCxLQUFLLENBQUUsSUFEc0IsQ0FBL0IsQ0FJRixDQUFDTCxLQUFLLENBQUUsQ0FBQ0oscUJBQXFCLENBQUVBLHFCQUF4QixDQUFSLENBSkUsQ0FBTixDQU1ILENBR0osQ0FBQyxNQUFPVyxDQUFQLENBQVUsMEJBQ1IsR0FBR0EsQ0FBSCxDQUFNLHFEQUNGLE1BQU9oQixDQUFBQSxHQUFHLENBQUNpQixJQUFKLENBQVNELENBQVQsQ0FBUCxDQUNILENBRkQsaUNBR0gsQ0E5Q2dFLHlCQWdEakUsTUFBT2hCLENBQUFBLEdBQUcsQ0FBQ2lCLElBQUosQ0FBUyxTQUFULENBQVAsQ0FFSCxDQWxERCxFQXFEQTt5QkFDQXhCLE1BQU0sQ0FBQ3lCLEdBQVAsQ0FBVyxtQkFBWCxDQUFnQ3JCLGFBQWhDLENBQStDLE1BQU9FLEdBQVAsQ0FBWUMsR0FBWixHQUFvQix5QkFFL0QsS0FBTW1CLENBQUFBLG9CQUFvQiwyQkFBR3BCLEdBQUcsQ0FBQ3FCLE1BQUosQ0FBV0MsRUFBZCxDQUExQixDQUVBLEtBQU1kLENBQUFBLGNBQWMsMkJBQUcsS0FBTVgsQ0FBQUEsdUJBQXVCLENBQUNZLE9BQXhCLENBQWdDLENBQ3pEQyxLQUFLLENBQUUsQ0FDSEoscUJBQXFCLENBQUVjLG9CQURwQixDQURrRCxDQUFoQyxDQUFULENBQXBCLENBT0EsS0FBTUcsQ0FBQUEsWUFBWSwyQkFBR2YsY0FBYyxDQUFDLENBQUQsQ0FBakIsQ0FBbEIsQ0FYK0QseUJBYS9EUCxHQUFHLENBQUNpQixJQUFKLENBQVNLLFlBQVQsRUFFSCxDQWZELEVBa0JBO3lCQUNBN0IsTUFBTSxDQUFDeUIsR0FBUCxDQUFXLHdCQUFYLENBQXFDckIsYUFBckMsQ0FBb0QsTUFBT0UsR0FBUCxDQUFZQyxHQUFaLEdBQW9CLHlCQUVwRSxLQUFNbUIsQ0FBQUEsb0JBQW9CLDJCQUFHcEIsR0FBRyxDQUFDcUIsTUFBSixDQUFXQyxFQUFkLENBQTFCLENBQ0EsS0FBTUUsQ0FBQUEsR0FBRywyQkFBR3hCLEdBQUcsQ0FBQ3lCLElBQUosQ0FBU0QsR0FBWixDQUFULENBRUEsS0FBTUUsQ0FBQUEsYUFBYSwyQkFBRyxLQUFNOUIsQ0FBQUEsYUFBYSxDQUFDYSxPQUFkLENBQXNCLENBQzlDQyxLQUFLLENBQUUsQ0FDSEoscUJBQXFCLENBQUVjLG9CQURwQixDQUR1QyxDQUF0QixDQUFULENBQW5CLENBTG9FLHlCQVlwRSxHQUFJLDBCQUVBLEdBQUdJLEdBQUcsR0FBSyxVQUFYLENBQXNCLHFEQUNsQixLQUFNM0IsQ0FBQUEsdUJBQXVCLENBQUNtQixNQUF4QixDQUErQixDQUM3QkQsS0FBSyxDQUFFLEtBRHNCLENBQS9CLENBR0YsQ0FBQ0wsS0FBSyxDQUFFLENBQUNKLHFCQUFxQixDQUFFYyxvQkFBeEIsQ0FBUixDQUhFLENBQU4sQ0FLSCxDQU5ELGlDQVFILENBQUMsTUFBT0gsQ0FBUCxDQUFVLDBCQUNSLEdBQUdBLENBQUgsQ0FBTSxxREFDRixNQUFPaEIsQ0FBQUEsR0FBRyxDQUFDaUIsSUFBSixDQUFTRCxDQUFULENBQVAsQ0FDSCxDQUZELGlDQUdILENBMUJtRSx5QkErQnBFaEIsR0FBRyxDQUFDaUIsSUFBSixDQUFTUSxhQUFULEVBRUgsQ0FqQ0QsRUFrQ0E7eUJBQ0FoQyxNQUFNLENBQUNpQyxNQUFQLENBQWMsbUNBQWQsQ0FBbUQ3QixhQUFuRCxDQUFrRSxNQUFPRSxHQUFQLENBQVlDLEdBQVosR0FBb0IseUJBQ2xGLEtBQU0yQixDQUFBQSxhQUFhLDJCQUFHNUIsR0FBRyxDQUFDcUIsTUFBSixDQUFXTyxhQUFkLENBQW5CLENBRUEsS0FBTUMsQ0FBQUEsV0FBVywyQkFBRyxLQUFNakMsQ0FBQUEsYUFBYSxDQUFDa0MsUUFBZCxDQUF1QkYsYUFBdkIsQ0FBVCxDQUFqQixDQUhrRix5QkFLbEYsR0FBR0MsV0FBSCxDQUFlLHFEQUNYLEtBQU1qQyxDQUFBQSxhQUFhLENBQUNtQyxPQUFkLENBQXNCLENBQ3hCckIsS0FBSyxDQUFFLENBQ0hZLEVBQUUsQ0FBRU0sYUFERCxDQURpQixDQUF0QixDQUFOLENBRFcseUJBT1gzQixHQUFHLENBQUNpQixJQUFKLENBQVMsc0JBQVQsRUFDSCxDQVJELElBUU8scURBQ0gsTUFBT2pCLENBQUFBLEdBQUcsQ0FBQ2lCLElBQUosQ0FBUyxDQUFDYyxLQUFLLENBQUUsc0NBQVIsQ0FBVCxDQUFQLENBQ0gsQ0FHSixDQWxCRCxFLHlCQXFCQUMsTUFBTSxDQUFDQyxPQUFQLENBQWlCeEMsTUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZShcImV4cHJlc3NcIik7XHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbmNvbnN0IHsgT2JzZXJ2YWNpb25lcywgTm90aWZpY2FjaW9uT2JzZXJ2YWNpb24gfSA9IHJlcXVpcmUoXCIuLi9tb2RlbHNcIik7XHJcbmNvbnN0IHsgdmFsaWRhdGVUb2tlbiB9ID0gcmVxdWlyZShcIi4uL21pZGRsZXdhcmVzL0F1dGhNaWRkbGV3YXJlXCIpO1xyXG5cclxuXHJcbi8vY3JlYXIgdW5hIG9ic2VydmFjaW9uXHJcbnJvdXRlci5wb3N0KFwiL2NyZWF0ZU9ic2VydmFjaW9uXCIsIHZhbGlkYXRlVG9rZW4sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgY29uc3Qge3RpdHVsbywgZGVzY3JpcGNpb24sIHVzZXJuYW1lLCBVc2VySWQsIFBlcnNvbmFzRGVwZW5kaWVudGVJZH0gPSByZXEuYm9keTtcclxuICAgIC8vY29uc3QgdXNlcm5hbWUgPSByZXEudXNlci51c2VybmFtZTtcclxuICAgIC8vY29uc3QgdXNlcklkID0gcmVxLnVzZXIuaWQ7XHJcblxyXG5cclxuICAgIHRyeSB7XHJcblxyXG4gICAgICAgIC8vIEJ1c2NhIHNpIGVzdGEgY3JlYWRhIGxhIG5vdGlmaWNhY2lvbiBwYXJhIGVzYSBwZXJzb25hXHJcbiAgICAgICAgY29uc3Qgbm90aWZpY2FjaW9uZXMgPSBhd2FpdCBOb3RpZmljYWNpb25PYnNlcnZhY2lvbi5maW5kQWxsKHtcclxuICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgIFBlcnNvbmFzRGVwZW5kaWVudGVJZDogUGVyc29uYXNEZXBlbmRpZW50ZUlkLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgYXdhaXQgT2JzZXJ2YWNpb25lcy5jcmVhdGUoe1xyXG4gICAgICAgICAgICB0aXR1bG86IHRpdHVsbyxcclxuICAgICAgICAgICAgZGVzY3JpcGNpb246IGRlc2NyaXBjaW9uLFxyXG4gICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgIFBlcnNvbmFzRGVwZW5kaWVudGVJZDogUGVyc29uYXNEZXBlbmRpZW50ZUlkLFxyXG4gICAgICAgICAgICBVc2VySWQ6IFVzZXJJZCxcclxuXHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZihub3RpZmljYWNpb25lcy5sZW5ndGggPT09IDApIHtcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiPT09PT09PT09PT09PT09PT1cIiArIFBlcnNvbmFzRGVwZW5kaWVudGVJZCk7XHJcbiAgICAgICAgICAgIGF3YWl0IE5vdGlmaWNhY2lvbk9ic2VydmFjaW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBudWV2YTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIFBlcnNvbmFzRGVwZW5kaWVudGVJZDogUGVyc29uYXNEZXBlbmRpZW50ZUlkLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhd2FpdCBOb3RpZmljYWNpb25PYnNlcnZhY2lvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIG51ZXZhOiB0cnVlLFxyXG5cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7d2hlcmU6IHtQZXJzb25hc0RlcGVuZGllbnRlSWQ6IFBlcnNvbmFzRGVwZW5kaWVudGVJZH19XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgaWYoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oZSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlcy5qc29uKFwiU1VDQ0VTU1wiKTtcclxuXHJcbn0pO1xyXG5cclxuXHJcbi8vVkVSIFNJIEhBWSBOT1RJRklDQUNJT05cclxucm91dGVyLmdldCgnL25vdGlmaWNhY2lvbi86aWQnLCB2YWxpZGF0ZVRva2VuLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuXHJcbiAgICBjb25zdCBwZXJzb25hRGVwZW5kaWVudGVJZCA9IHJlcS5wYXJhbXMuaWQ7XHJcblxyXG4gICAgY29uc3Qgbm90aWZpY2FjaW9uZXMgPSBhd2FpdCBOb3RpZmljYWNpb25PYnNlcnZhY2lvbi5maW5kQWxsKHtcclxuICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICBQZXJzb25hc0RlcGVuZGllbnRlSWQ6IHBlcnNvbmFEZXBlbmRpZW50ZUlkLFxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IG5vdGlmaWNhY2lvbiA9IG5vdGlmaWNhY2lvbmVzWzBdXHJcblxyXG4gICAgcmVzLmpzb24obm90aWZpY2FjaW9uKTtcclxuXHJcbn0pO1xyXG5cclxuXHJcbi8vVkVSIFJFR0lTVFJPIERFIFVOIERJQVxyXG5yb3V0ZXIuZ2V0KCcvc2hvd09ic2VydmFjaW9uZXMvOmlkJywgdmFsaWRhdGVUb2tlbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcblxyXG4gICAgY29uc3QgcGVyc29uYURlcGVuZGllbnRlSWQgPSByZXEucGFyYW1zLmlkO1xyXG4gICAgY29uc3Qgcm9sID0gcmVxLnVzZXIucm9sO1xyXG5cclxuICAgIGNvbnN0IG9ic2VydmFjaW9uZXMgPSBhd2FpdCBPYnNlcnZhY2lvbmVzLmZpbmRBbGwoe1xyXG4gICAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgICAgIFBlcnNvbmFzRGVwZW5kaWVudGVJZDogcGVyc29uYURlcGVuZGllbnRlSWQsXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pXHJcblxyXG4gICAgdHJ5IHtcclxuXHJcbiAgICAgICAgaWYocm9sID09PSBcIkZBTUlMSUFSXCIpe1xyXG4gICAgICAgICAgICBhd2FpdCBOb3RpZmljYWNpb25PYnNlcnZhY2lvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIG51ZXZhOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7d2hlcmU6IHtQZXJzb25hc0RlcGVuZGllbnRlSWQ6IHBlcnNvbmFEZXBlbmRpZW50ZUlkfX1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGlmKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKGUpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcblxyXG5cclxuICAgIHJlcy5qc29uKG9ic2VydmFjaW9uZXMpO1xyXG5cclxufSk7XHJcbi8vQm9ycmFyIHVuYSBvYnNlcnZhY2lvblxyXG5yb3V0ZXIuZGVsZXRlKFwiL2RlbGV0ZU9ic2VydmFjaW9uLzpvYnNlcnZhY2lvbklkXCIsIHZhbGlkYXRlVG9rZW4sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgY29uc3Qgb2JzZXJ2YWNpb25JZCA9IHJlcS5wYXJhbXMub2JzZXJ2YWNpb25JZDtcclxuXHJcbiAgICBjb25zdCBvYnNlcnZhY2lvbiA9IGF3YWl0IE9ic2VydmFjaW9uZXMuZmluZEJ5UGsob2JzZXJ2YWNpb25JZClcclxuXHJcbiAgICBpZihvYnNlcnZhY2lvbil7XHJcbiAgICAgICAgYXdhaXQgT2JzZXJ2YWNpb25lcy5kZXN0cm95KHtcclxuICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgIGlkOiBvYnNlcnZhY2lvbklkLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXMuanNvbihcIkRFTEVURUQgU1VDQ0VTU0ZVTExZXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oe2Vycm9yOiBcIlRoZXJlIGlzIG5vIG9ic2VydmFjaW9uIHdpdGggdGhpcyBpZFwifSlcclxuICAgIH1cclxuXHJcblxyXG59KTtcclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjsiXX0=